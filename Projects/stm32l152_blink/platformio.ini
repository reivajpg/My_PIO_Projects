[env:nucleo_l152re]
;platform_packages =
;  platformio/tool-openocd@2.1100.211028
platform = ststm32
board = nucleo_l152re
framework = stm32cube ;mbed ;arduino
;build_flags = -DL1

; Configuración del monitor serial
;monitor_speed = 115200

; Configuración específica para STM32L152RCT6 (256KB Flash / 32KB RAM)
; La placa nucleo_l152re usa el STM32L152RET6 (512KB Flash / 80KB RAM)
board_build.mcu = stm32l152rct6
board_upload.maximum_size = 262144
board_upload.maximum_ram_size = 32768

; Protocolo de subida (ST-Link por defecto)
;debug_tool = stlink
;upload_protocol = stlink
;upload_speed = 4000
; ==============================================================================
; Solución de problemas de subida (Upload Troubleshooting)
; ==============================================================================
; Si recibes errores como "Error: init mode failed (unable to connect to the target)"
; o "Error: target not halted", intenta una de las siguientes opciones descomentando:

; Opción 1: Forzar reinicio por software (útil si no tienes el pin NRST conectado)
 ;upload_flags = -c set CPUTAPID 0x2ba01477 -c reset_config none separate

; Opción 2: Usar protocolo HLA (para clones de ST-Link V2 chinos)
 ;upload_flags = -c transport select hla_swd
 ;               -c reset_config none

; Opción 3: Forzar ID del chip (si OpenOCD no lo detecta automáticamente)
; Revisa el ID correcto en la salida de OpenOCD (ej. 0x4ba00477 para STM32L1)
; upload_flags = -c set CPUTAPID 0x427 

; --- CONFIGURACIÓN PARA TRABAJAR SIN PIN NRST ---
;upload_flags = -c reset_config none

[env:nucleo_l152re_cube]
upload_command =
   c:\Users\Javier\AppData\Local\stm32cube\bundles\programmer\2.21.0\bin\STM32_Programmer_CLI.exe -c port=SWD -w $SOURCE 0x8000000
